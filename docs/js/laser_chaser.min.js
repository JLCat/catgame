"use strict";var polifill=function(){for(var e=0,n=["ms","moz","webkit","o"],a=0;a<n.length&&!window.requestAnimationFrame;++a)window.requestAnimationFrame=window[n[a]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n[a]+"CancelAnimationFrame"]||window[n[a]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n,a){var t=(new Date).getTime(),o=Math.max(0,16-(t-e)),r=window.setTimeout(function(){n(t+o)},o);return e=t+o,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})},canvas=null,context=null,pause=!1,border=10,frameRate=1e3/60,frame=null,now=null,then=Date.now(),delta=null,laser={x:window.innerWidth/2,y:window.innerHeight/2,dx:0,dy:0,speed:5,stat:"moving"},coordinate={x:window.innerWidth/2,y:window.innerHeight/2},hitbox={left:0,right:0,top:0,buttom:0},onImageLoad=function(){console.log("Image loaded!")},setup=function(){canvas=document.getElementById("canvas"),context=canvas.getContext("2d"),canvas.width=window.innerWidth,canvas.height=window.innerHeight,(frame=new Image).onload=onImageLoad(),frame.src="imgs/point.png"},tick=function e(){pause||(requestAnimationFrame(e),now=Date.now(),(delta=now-then)>frameRate&&(then=now-delta%frameRate,animate()))},clearScreen=function(){context.clearRect(0,0,canvas.width,canvas.height)},randomCoordinate=function(){coordinate.x=border+Math.round(Math.random()*(window.innerWidth-2*border)),coordinate.y=border+Math.round(Math.random()*(window.innerHeight-2*border))},getSpeed=function(e,n,a,t){var o=a-e,r=t-n,i=Math.sqrt(Math.pow(o,2)+Math.pow(r,2)),d=Math.random();return[o/i*laser.speed*d,r/i*laser.speed*d]},doMoving=function(){if(coordinate.x>hitbox.left&&coordinate.x<hitbox.right&&coordinate.y>hitbox.top&&coordinate.y<hitbox.buttom){randomCoordinate();var e=10*Math.random()+1,n=getSpeed(laser.x,laser.y,coordinate.x,coordinate.y);laser.dx=n[0]*e,laser.dy=n[1]*e}},doTwinkle=function(){var e=10*Math.random();Math.round(e)>5?(laser.dx=5*Math.random(),laser.dy=5*Math.random()):Math.round(e)<=5&&(laser.dx=-5*Math.random(),laser.dy=-5*Math.random())},doBlink=function(){randomCoordinate(),laser.x=coordinate.x,laser.y=coordinate.y},ticks=0,timer=0,animate=function(){clearScreen();var e=laser.x-25,n=laser.y-25;hitbox.left=e,hitbox.right=e+50,hitbox.top=n,hitbox.buttom=n+50;Math.round(10*Math.random());var a=1e3*Math.random();a<10?doBlink():a<50?doTwinkle():doMoving(),laser.x+=laser.dx,laser.y+=laser.dy,context.drawImage(frame,e,n,50,50),hitbox.left<border&&(laser.dx=Math.random()*laser.speed+laser.speed),hitbox.right>window.innerWidth-border&&(laser.dx=-1*(Math.random()*laser.speed+laser.speed)),hitbox.top<border&&(laser.dy=Math.random()*laser.speed+laser.speed),hitbox.buttom>window.innerHeight-border&&(laser.dy=-1*(Math.random()*laser.speed+laser.speed))},gameStart=function(){pause=!1,tick()},gameStop=function(){pause=!0},gameListener=function(){var e=$(".control-button");e.click(function(){e.hasClass("start")?gameStart():gameStop(),e.toggleClass("start"),e.toggleClass("stop")})};$(document).ready(function(){polifill(),setup(),gameListener()}),$(window).resize(function(){canvas.width=window.innerWidth,canvas.height=window.innerHeight});